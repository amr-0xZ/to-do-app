<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List App</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for a nice, clean font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the app */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Style for the custom checkbox */
        .custom-checkbox:checked {
            background-color: #115e59; /* Dark Teal */
            border-color: #115e59; /* Dark Teal */
        }

        .custom-checkbox:checked::before {
            content: 'âœ“';
            color: white;
            display: block;
            text-align: center;
            line-height: 1.25rem; /* Matches h-5 */
            font-size: 0.8rem;
        }

        /* Animation for tasks appearing */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .task-item {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-slate-800 to-gray-900 min-h-screen flex items-center justify-center p-4">

    <!-- Main App Container -->
    <div class="w-full max-w-2xl mx-auto bg-gray-800/50 backdrop-blur-sm rounded-2xl shadow-2xl p-6 md:p-8">
        
        <!-- Header -->
        <header class="text-center mb-6">
            <h1 class="text-4xl md:text-5xl font-bold text-white tracking-tight">My To-Do List</h1>
            <p class="text-gray-400 mt-2">Stay organized, one task at a time.</p>
        </header>
        
        <!-- Add Task Form -->
        <form id="add-task-form" class="flex gap-3 mb-6">
            <input 
                type="text" 
                id="task-input" 
                placeholder="e.g., Learn a new skill" 
                class="flex-grow bg-gray-700/50 text-gray-100 placeholder-gray-400 rounded-lg px-4 py-3 border-2 border-transparent focus:outline-none focus:ring-2 focus:ring-gray-200 focus:border-transparent transition"
                aria-label="New task input"
            >
            <button 
                type="submit" 
                class="bg-teal-800 text-white font-semibold rounded-lg px-5 py-3 hover:bg-teal-700 active:scale-95 transition-all shadow-lg"
                aria-label="Add new task"
            >
                Add Task
            </button>
        </form>

        <!-- View Toggles -->
        <div class="flex border-b border-gray-700 mb-4">
            <button id="active-view-btn" class="flex-1 py-2 text-center font-semibold text-white border-b-2 border-teal-500 transition-colors">Active</button>
            <button id="completed-view-btn" class="flex-1 py-2 text-center font-semibold text-gray-400 border-b-2 border-transparent hover:text-white transition-colors">Completed</button>
        </div>

        <!-- Task List Container (Active) -->
        <div id="active-tasks-container">
            <ul id="task-list" class="space-y-3">
                <!-- Tasks will be dynamically inserted here -->
            </ul>
            <!-- Empty State Message -->
            <div id="empty-state" class="text-center p-8 bg-black/20 rounded-lg mt-6 hidden">
                 <svg class="mx-auto h-12 w-12 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                 </svg>
                 <h3 class="mt-2 text-xl font-medium text-white">All caught up!</h3>
                 <p class="mt-1 text-sm text-gray-400">You have no pending tasks. Add one above to get started.</p>
            </div>
        </div>

        <!-- Task List Container (Completed) -->
        <div id="completed-tasks-container" class="hidden">
            <ul id="completed-task-list" class="space-y-3">
                <!-- Completed tasks will be dynamically inserted here -->
            </ul>
             <!-- Completed Empty State Message -->
            <div id="completed-empty-state" class="text-center p-8 bg-black/20 rounded-lg mt-6 hidden">
                 <svg class="mx-auto h-12 w-12 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                 </svg>
                 <h3 class="mt-2 text-xl font-medium text-white">No completed tasks</h3>
                 <p class="mt-1 text-sm text-gray-400">Once you complete a task, it will show up here.</p>
            </div>
        </div>
    </div>
    
    <!-- Edit Modal (hidden by default) -->
    <div id="edit-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 rounded-2xl shadow-xl w-full max-w-md p-6">
            <h2 class="text-2xl font-bold text-gray-100 mb-4">Edit Task</h2>
            <input 
                type="text" 
                id="edit-input" 
                class="w-full rounded-lg px-4 py-3 border border-gray-600 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-teal-500"
                aria-label="Edit task input"
            >
            <div class="flex justify-end gap-3 mt-5">
                <button 
                    id="cancel-edit" 
                    class="bg-gray-600 text-gray-200 font-semibold rounded-lg px-5 py-2 hover:bg-gray-500 transition"
                >
                    Cancel
                </button>
                <button 
                    id="save-edit" 
                    class="bg-teal-800 text-white font-semibold rounded-lg px-5 py-2 hover:bg-teal-700 transition"
                >
                    Save
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM Elements
            const addTaskForm = document.getElementById('add-task-form');
            const taskInput = document.getElementById('task-input');
            const taskList = document.getElementById('task-list');
            const completedTaskList = document.getElementById('completed-task-list');
            const emptyState = document.getElementById('empty-state');
            const completedEmptyState = document.getElementById('completed-empty-state');
            const editModal = document.getElementById('edit-modal');
            const editInput = document.getElementById('edit-input');
            const saveEditBtn = document.getElementById('save-edit');
            const cancelEditBtn = document.getElementById('cancel-edit');
            const activeViewBtn = document.getElementById('active-view-btn');
            const completedViewBtn = document.getElementById('completed-view-btn');
            const activeTasksContainer = document.getElementById('active-tasks-container');
            const completedTasksContainer = document.getElementById('completed-tasks-container');


            // State
            let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
            let currentEditId = null;

            // --- Functions ---

            const saveTasks = () => {
                localStorage.setItem('tasks', JSON.stringify(tasks));
            };

            const renderLists = () => {
                taskList.innerHTML = '';
                completedTaskList.innerHTML = '';

                const activeTasks = tasks.filter(task => !task.completed);
                const completedTasks = tasks.filter(task => task.completed);

                // Render active tasks
                if (activeTasks.length === 0) {
                    emptyState.classList.remove('hidden');
                } else {
                    emptyState.classList.add('hidden');
                    activeTasks.forEach(task => {
                        const li = document.createElement('li');
                        li.className = `task-item flex items-center gap-4 p-4 rounded-lg transition-all bg-gray-700/60`;
                        li.dataset.id = task.id;

                        li.innerHTML = `
                            <input 
                                type="checkbox" 
                                class="custom-checkbox appearance-none h-5 w-5 rounded border-2 border-gray-500 cursor-pointer transition-colors flex-shrink-0"
                                aria-label="Mark task as complete"
                            >
                            <span class="flex-grow text-lg text-gray-100">${task.text}</span>
                            <div class="flex gap-2">
                                <button class="edit-btn p-2 rounded-md hover:bg-gray-600/50 transition-colors" aria-label="Edit task">
                                    <svg class="w-5 h-5 text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"></path></svg>
                                </button>
                                <button class="delete-btn p-2 rounded-md hover:bg-gray-600/50 transition-colors" aria-label="Delete task">
                                    <svg class="w-5 h-5 text-rose-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                </button>
                            </div>
                        `;
                        taskList.appendChild(li);
                    });
                }
                
                // Render completed tasks
                if (completedTasks.length === 0) {
                    completedEmptyState.classList.remove('hidden');
                } else {
                    completedEmptyState.classList.add('hidden');
                    completedTasks.forEach(task => {
                        const li = document.createElement('li');
                        li.className = `task-item flex items-center justify-between gap-4 p-4 rounded-lg bg-teal-900/50`;
                        li.dataset.id = task.id;
                        const completedTime = new Date(task.completedAt).toLocaleString('en-US', { dateStyle: 'medium', timeStyle: 'short' });

                        li.innerHTML = `
                            <div>
                                <span class="flex-grow text-lg line-through text-gray-400">${task.text}</span>
                                <p class="text-xs text-gray-500 mt-1">Completed: ${completedTime}</p>
                            </div>
                            <div class="flex gap-2">
                                <button class="uncheck-btn p-2 rounded-md hover:bg-gray-600/50 transition-colors" aria-label="Mark task as incomplete">
                                    <svg class="w-5 h-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422A12.083 12.083 0 0121 12c0 6.627-5.373 12-12 12S-3 18.627-3 12a12.083 12.083 0 012.84-6.422L12 14z"></path></svg>
                                </button>
                                <button class="delete-btn p-2 rounded-md hover:bg-gray-600/50 transition-colors" aria-label="Delete task">
                                    <svg class="w-5 h-5 text-rose-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                </button>
                            </div>
                        `;
                        completedTaskList.appendChild(li);
                    });
                }
            };

            const addTask = (text) => {
                if (text.trim() === '') return;
                const newTask = {
                    id: Date.now(),
                    text: text.trim(),
                    completed: false,
                    completedAt: null
                };
                tasks.unshift(newTask); // Add to the beginning of the array
                saveTasks();
                renderLists();
            };

            const toggleComplete = (id) => {
                const task = tasks.find(t => t.id === id);
                if (task) {
                    task.completed = !task.completed;
                    task.completedAt = task.completed ? new Date().toISOString() : null;
                    saveTasks();
                    renderLists();
                }
            };

            const deleteTask = (id) => {
                tasks = tasks.filter(t => t.id !== id);
                saveTasks();
                renderLists();
            };
            
            const openEditModal = (id) => {
                const task = tasks.find(t => t.id === id);
                if(task){
                    currentEditId = id;
                    editInput.value = task.text;
                    editModal.classList.remove('hidden');
                    editInput.focus();
                }
            };

            const closeEditModal = () => {
                editModal.classList.add('hidden');
                currentEditId = null;
                editInput.value = '';
            };
            
            const saveTaskEdit = () => {
                const newText = editInput.value.trim();
                if(newText && currentEditId) {
                    const task = tasks.find(t => t.id === currentEditId);
                    if(task){
                       task.text = newText;
                       saveTasks();
                       renderLists();
                    }
                }
                closeEditModal();
            };

            // --- Event Listeners ---

            addTaskForm.addEventListener('submit', (e) => {
                e.preventDefault();
                addTask(taskInput.value);
                taskInput.value = '';
            });

            // Combined listener for both lists
            [taskList, completedTaskList].forEach(list => {
                list.addEventListener('click', (e) => {
                    const target = e.target;
                    const taskItem = target.closest('.task-item');
                    if (!taskItem) return;
                    
                    const taskId = Number(taskItem.dataset.id);
                    
                    if (target.closest('.delete-btn')) {
                        taskItem.style.transition = 'opacity 0.3s, transform 0.3s';
                        taskItem.style.opacity = '0';
                        taskItem.style.transform = 'translateX(20px)';
                        setTimeout(() => deleteTask(taskId), 300);
                    } else if (target.closest('.edit-btn')) {
                        openEditModal(taskId);
                    } else if (target.type === 'checkbox' || target.closest('.uncheck-btn')) {
                        toggleComplete(taskId);
                    }
                });
            });


            saveEditBtn.addEventListener('click', saveTaskEdit);
            editInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    saveTaskEdit();
                }
            });
            cancelEditBtn.addEventListener('click', closeEditModal);
            editModal.addEventListener('click', (e) => {
                // Close modal if clicking on the background overlay
                if(e.target === editModal){
                    closeEditModal();
                }
            });

            activeViewBtn.addEventListener('click', () => {
                activeTasksContainer.classList.remove('hidden');
                completedTasksContainer.classList.add('hidden');
                activeViewBtn.classList.add('text-white', 'border-teal-500');
                activeViewBtn.classList.remove('text-gray-400', 'border-transparent');
                completedViewBtn.classList.add('text-gray-400', 'border-transparent');
                completedViewBtn.classList.remove('text-white', 'border-teal-500');
            });

            completedViewBtn.addEventListener('click', () => {
                completedTasksContainer.classList.remove('hidden');
                activeTasksContainer.classList.add('hidden');
                completedViewBtn.classList.add('text-white', 'border-teal-500');
                completedViewBtn.classList.remove('text-gray-400', 'border-transparent');
                activeViewBtn.classList.add('text-gray-400', 'border-transparent');
                activeViewBtn.classList.remove('text-white', 'border-teal-500');
            });
            
            // Initial render
            renderLists();
        });
    </script>
</body>
</html>

